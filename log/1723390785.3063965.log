2024-08-11 16:39:45,306 - root - INFO - Namespace(data='lastfm', seed=142, bs=200, prefix='pint_lastfm', n_degree=10, n_epoch=50, n_layer=2, lr=0.0001, patience=5, n_runs=2, gpu=0, node_dim=100, time_dim=1, backprop_every=1, use_memory=True, message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, beta=0.0001, r_dim=4)
2024-08-11 16:40:08,721 - root - INFO - num of training instances: 722758
2024-08-11 16:40:08,721 - root - INFO - num of batches per epoch: 3614
2024-08-11 16:40:09,952 - root - INFO - start 0 epoch
2024-08-11 16:49:32,580 - root - INFO - epoch: 0 took 562.63s
2024-08-11 16:49:32,581 - root - INFO - Epoch mean loss: 1.0351759820731226
2024-08-11 16:49:32,581 - root - INFO - val auc: 0.704093408724073, new node val auc: 0.6045081164883349
2024-08-11 16:49:32,581 - root - INFO - val ap: 0.7208691396977044, new node val ap: 0.6706207961916962
2024-08-11 16:49:32,665 - root - INFO - start 1 epoch
2024-08-11 16:58:45,582 - root - INFO - epoch: 1 took 552.93s
2024-08-11 16:58:45,582 - root - INFO - Epoch mean loss: 0.9481133649081371
2024-08-11 16:58:45,583 - root - INFO - val auc: 0.7509465704136017, new node val auc: 0.6513802794606547
2024-08-11 16:58:45,583 - root - INFO - val ap: 0.7653941449032552, new node val ap: 0.7064277587347001
2024-08-11 16:58:45,667 - root - INFO - start 2 epoch
2024-08-11 17:07:58,215 - root - INFO - epoch: 2 took 552.56s
2024-08-11 17:07:58,215 - root - INFO - Epoch mean loss: 0.8973330637088585
2024-08-11 17:07:58,215 - root - INFO - val auc: 0.7331221862959492, new node val auc: 0.6740689672690434
2024-08-11 17:07:58,215 - root - INFO - val ap: 0.7494941442014557, new node val ap: 0.722199758106456
2024-08-11 17:07:58,301 - root - INFO - start 3 epoch
2024-08-11 17:17:09,118 - root - INFO - epoch: 3 took 550.83s
2024-08-11 17:17:09,119 - root - INFO - Epoch mean loss: 0.8708957004642777
2024-08-11 17:17:09,119 - root - INFO - val auc: 0.7648530083875303, new node val auc: 0.6842162756472424
2024-08-11 17:17:09,119 - root - INFO - val ap: 0.7801100623724203, new node val ap: 0.7363633368821636
2024-08-11 17:17:09,203 - root - INFO - start 4 epoch
2024-08-11 17:26:17,364 - root - INFO - epoch: 4 took 548.17s
2024-08-11 17:26:17,365 - root - INFO - Epoch mean loss: 0.8634019473770671
2024-08-11 17:26:17,365 - root - INFO - val auc: 0.7550224558376645, new node val auc: 0.7168472022837902
2024-08-11 17:26:17,365 - root - INFO - val ap: 0.772308329020834, new node val ap: 0.7604315751186689
2024-08-11 17:26:17,449 - root - INFO - start 5 epoch
2024-08-11 17:35:21,691 - root - INFO - epoch: 5 took 544.25s
2024-08-11 17:35:21,691 - root - INFO - Epoch mean loss: 0.8403482607998238
2024-08-11 17:35:21,691 - root - INFO - val auc: 0.7909591830914582, new node val auc: 0.7335696678080962
2024-08-11 17:35:21,691 - root - INFO - val ap: 0.8057164893491189, new node val ap: 0.7795177746232845
2024-08-11 17:35:21,775 - root - INFO - start 6 epoch
2024-08-11 17:44:23,314 - root - INFO - epoch: 6 took 541.55s
2024-08-11 17:44:23,314 - root - INFO - Epoch mean loss: 0.8252925850949897
2024-08-11 17:44:23,314 - root - INFO - val auc: 0.7595777980484317, new node val auc: 0.693328217454293
2024-08-11 17:44:23,315 - root - INFO - val ap: 0.7793347464248024, new node val ap: 0.7529795776890299
2024-08-11 17:44:23,399 - root - INFO - start 7 epoch
2024-08-11 17:53:26,447 - root - INFO - epoch: 7 took 543.06s
2024-08-11 17:53:26,448 - root - INFO - Epoch mean loss: 0.8209938149410648
2024-08-11 17:53:26,448 - root - INFO - val auc: 0.7783658974468205, new node val auc: 0.7119097575593097
2024-08-11 17:53:26,448 - root - INFO - val ap: 0.7954056409599438, new node val ap: 0.7675402473072455
2024-08-11 17:53:26,531 - root - INFO - start 8 epoch
2024-08-11 18:02:29,087 - root - INFO - epoch: 8 took 542.57s
2024-08-11 18:02:29,088 - root - INFO - Epoch mean loss: 0.8130236537369431
2024-08-11 18:02:29,088 - root - INFO - val auc: 0.7741497697215832, new node val auc: 0.7376283948381577
2024-08-11 18:02:29,088 - root - INFO - val ap: 0.791945501630295, new node val ap: 0.7828133180103172
2024-08-11 18:02:29,172 - root - INFO - start 9 epoch
2024-08-11 18:11:32,560 - root - INFO - epoch: 9 took 543.40s
2024-08-11 18:11:32,563 - root - INFO - Epoch mean loss: 0.7991195946156682
2024-08-11 18:11:32,563 - root - INFO - val auc: 0.7854784924218757, new node val auc: 0.7705061548226726
2024-08-11 18:11:32,563 - root - INFO - val ap: 0.7930899654919729, new node val ap: 0.7976849953264543
2024-08-11 18:11:32,687 - root - INFO - start 10 epoch
2024-08-11 18:20:34,745 - root - INFO - epoch: 10 took 542.07s
2024-08-11 18:20:34,747 - root - INFO - Epoch mean loss: 0.7980767540184253
2024-08-11 18:20:34,747 - root - INFO - val auc: 0.7766579075785978, new node val auc: 0.7591061893615577
2024-08-11 18:20:34,748 - root - INFO - val ap: 0.7874115600247241, new node val ap: 0.7910340596978187
2024-08-11 18:20:34,748 - root - INFO - No improvement over 5 epochs, stop training
2024-08-11 18:20:34,748 - root - INFO - Loading the best model at epoch 5
2024-08-11 18:20:34,754 - root - INFO - Loaded the best model at epoch 5 for inference
2024-08-11 18:23:40,250 - root - INFO - Test statistics: Old nodes -- auc: 0.7682440586629216, ap: 0.7849637651053718
2024-08-11 18:23:40,253 - root - INFO - Test statistics: New nodes -- auc: 0.7890379301145746, ap: 0.8169939108584452
2024-08-11 18:23:40,254 - root - INFO - Saving PINT model
2024-08-11 18:23:40,388 - root - INFO - PINT model saved
2024-08-11 18:23:40,484 - root - INFO - num of training instances: 722758
2024-08-11 18:23:40,485 - root - INFO - num of batches per epoch: 3614
2024-08-11 18:23:41,589 - root - INFO - start 0 epoch
2024-08-11 18:32:44,394 - root - INFO - epoch: 0 took 542.81s
2024-08-11 18:32:44,394 - root - INFO - Epoch mean loss: 1.0342216617043796
2024-08-11 18:32:44,395 - root - INFO - val auc: 0.7042335846634101, new node val auc: 0.5921202151587958
2024-08-11 18:32:44,395 - root - INFO - val ap: 0.7240532531305014, new node val ap: 0.6560532228517536
2024-08-11 18:32:44,478 - root - INFO - start 1 epoch
2024-08-11 18:41:47,917 - root - INFO - epoch: 1 took 543.45s
2024-08-11 18:41:47,918 - root - INFO - Epoch mean loss: 0.9575165384338254
2024-08-11 18:41:47,918 - root - INFO - val auc: 0.7147418130579459, new node val auc: 0.627580847115629
2024-08-11 18:41:47,918 - root - INFO - val ap: 0.730067792338064, new node val ap: 0.6768023803280969
2024-08-11 18:41:48,002 - root - INFO - start 2 epoch
2024-08-11 18:50:53,117 - root - INFO - epoch: 2 took 545.13s
2024-08-11 18:50:53,117 - root - INFO - Epoch mean loss: 0.9113632936337803
2024-08-11 18:50:53,118 - root - INFO - val auc: 0.7896021485946627, new node val auc: 0.7436416800365576
2024-08-11 18:50:53,118 - root - INFO - val ap: 0.7973265172217363, new node val ap: 0.7692887959277412
2024-08-11 18:50:53,201 - root - INFO - start 3 epoch
2024-08-11 18:59:57,032 - root - INFO - epoch: 3 took 543.84s
2024-08-11 18:59:57,033 - root - INFO - Epoch mean loss: 0.8738950874819305
2024-08-11 18:59:57,033 - root - INFO - val auc: 0.7387568859399999, new node val auc: 0.6794866040842689
2024-08-11 18:59:57,033 - root - INFO - val ap: 0.7564142009505296, new node val ap: 0.7336417656664612
2024-08-11 18:59:57,116 - root - INFO - start 4 epoch
2024-08-11 19:08:59,350 - root - INFO - epoch: 4 took 542.25s
2024-08-11 19:08:59,351 - root - INFO - Epoch mean loss: 0.8573989591828749
2024-08-11 19:08:59,351 - root - INFO - val auc: 0.7830569114883607, new node val auc: 0.7129298884412304
2024-08-11 19:08:59,351 - root - INFO - val ap: 0.7923363463931976, new node val ap: 0.7560746700928271
2024-08-11 19:08:59,435 - root - INFO - start 5 epoch
2024-08-11 19:18:04,066 - root - INFO - epoch: 5 took 544.64s
2024-08-11 19:18:04,067 - root - INFO - Epoch mean loss: 0.8512355794993038
2024-08-11 19:18:04,067 - root - INFO - val auc: 0.7743915730406219, new node val auc: 0.7351298093693003
2024-08-11 19:18:04,067 - root - INFO - val ap: 0.787381024278955, new node val ap: 0.7694041224695553
2024-08-11 19:18:04,150 - root - INFO - start 6 epoch
2024-08-11 19:27:06,100 - root - INFO - epoch: 6 took 541.96s
2024-08-11 19:27:06,100 - root - INFO - Epoch mean loss: 0.8340472296564765
2024-08-11 19:27:06,100 - root - INFO - val auc: 0.7488742516661461, new node val auc: 0.7157614438783859
2024-08-11 19:27:06,100 - root - INFO - val ap: 0.7627498307674764, new node val ap: 0.7565064035248539
2024-08-11 19:27:06,184 - root - INFO - start 7 epoch
2024-08-11 19:36:07,065 - root - INFO - epoch: 7 took 540.89s
2024-08-11 19:36:07,065 - root - INFO - Epoch mean loss: 0.8285970600454862
2024-08-11 19:36:07,065 - root - INFO - val auc: 0.7949230563247282, new node val auc: 0.7881508708555002
2024-08-11 19:36:07,065 - root - INFO - val ap: 0.8020994802015005, new node val ap: 0.813950480849321
2024-08-11 19:36:07,149 - root - INFO - start 8 epoch
2024-08-11 19:45:08,067 - root - INFO - epoch: 8 took 540.93s
2024-08-11 19:45:08,068 - root - INFO - Epoch mean loss: 0.8243759335835599
2024-08-11 19:45:08,068 - root - INFO - val auc: 0.7693128036219743, new node val auc: 0.7300355307347853
2024-08-11 19:45:08,068 - root - INFO - val ap: 0.7822007725286817, new node val ap: 0.7753777417315083
2024-08-11 19:45:08,152 - root - INFO - start 9 epoch
2024-08-11 19:54:10,153 - root - INFO - epoch: 9 took 542.01s
2024-08-11 19:54:10,154 - root - INFO - Epoch mean loss: 0.8133958439570999
2024-08-11 19:54:10,154 - root - INFO - val auc: 0.74245706448269, new node val auc: 0.7825428230624634
2024-08-11 19:54:10,154 - root - INFO - val ap: 0.7516900134856167, new node val ap: 0.8072373288793349
2024-08-11 19:54:10,238 - root - INFO - start 10 epoch
2024-08-11 20:03:11,169 - root - INFO - epoch: 10 took 540.94s
2024-08-11 20:03:11,169 - root - INFO - Epoch mean loss: 0.8082292886089077
2024-08-11 20:03:11,169 - root - INFO - val auc: 0.7533831973554664, new node val auc: 0.8003688483202495
2024-08-11 20:03:11,169 - root - INFO - val ap: 0.7684595118265372, new node val ap: 0.823679336565938
2024-08-11 20:03:11,251 - root - INFO - start 11 epoch
2024-08-11 20:12:14,311 - root - INFO - epoch: 11 took 543.07s
2024-08-11 20:12:14,312 - root - INFO - Epoch mean loss: 0.8124279351600904
2024-08-11 20:12:14,312 - root - INFO - val auc: 0.8244300010650081, new node val auc: 0.8043424885657499
2024-08-11 20:12:14,312 - root - INFO - val ap: 0.8324639499512199, new node val ap: 0.8283279050401275
2024-08-11 20:12:14,394 - root - INFO - start 12 epoch
2024-08-11 20:21:17,025 - root - INFO - epoch: 12 took 542.64s
2024-08-11 20:21:17,025 - root - INFO - Epoch mean loss: 0.8103079574752658
2024-08-11 20:21:17,025 - root - INFO - val auc: 0.8144148379767686, new node val auc: 0.7968802468008711
2024-08-11 20:21:17,025 - root - INFO - val ap: 0.8242250566440867, new node val ap: 0.8223980005774908
2024-08-11 20:21:17,108 - root - INFO - start 13 epoch
2024-08-11 20:30:17,972 - root - INFO - epoch: 13 took 540.87s
2024-08-11 20:30:17,973 - root - INFO - Epoch mean loss: 0.7973605650536382
2024-08-11 20:30:17,973 - root - INFO - val auc: 0.8122017297979799, new node val auc: 0.8063520788683883
2024-08-11 20:30:17,973 - root - INFO - val ap: 0.8140709541827796, new node val ap: 0.8265027569177236
2024-08-11 20:30:18,055 - root - INFO - start 14 epoch
2024-08-11 20:39:19,905 - root - INFO - epoch: 14 took 541.86s
2024-08-11 20:39:19,905 - root - INFO - Epoch mean loss: 0.7911188636010169
2024-08-11 20:39:19,906 - root - INFO - val auc: 0.7983333000340803, new node val auc: 0.8138925041805853
2024-08-11 20:39:19,906 - root - INFO - val ap: 0.8072457144914789, new node val ap: 0.83618536752002
2024-08-11 20:39:19,987 - root - INFO - start 15 epoch
2024-08-11 20:48:19,574 - root - INFO - epoch: 15 took 539.60s
2024-08-11 20:48:19,574 - root - INFO - Epoch mean loss: 0.7893033664267434
2024-08-11 20:48:19,574 - root - INFO - val auc: 0.7863472647515454, new node val auc: 0.8258180516310603
2024-08-11 20:48:19,574 - root - INFO - val ap: 0.7939194461320548, new node val ap: 0.8429351941364409
2024-08-11 20:48:19,657 - root - INFO - start 16 epoch
2024-08-11 20:57:18,086 - root - INFO - epoch: 16 took 538.44s
2024-08-11 20:57:18,087 - root - INFO - Epoch mean loss: 0.7932711525283668
2024-08-11 20:57:18,087 - root - INFO - val auc: 0.829599603367319, new node val auc: 0.7995114756734502
2024-08-11 20:57:18,087 - root - INFO - val ap: 0.8383471919540928, new node val ap: 0.8247217448722324
2024-08-11 20:57:18,168 - root - INFO - start 17 epoch
2024-08-11 21:06:18,300 - root - INFO - epoch: 17 took 540.14s
2024-08-11 21:06:18,300 - root - INFO - Epoch mean loss: 0.7808347297682905
2024-08-11 21:06:18,301 - root - INFO - val auc: 0.7933532873013168, new node val auc: 0.8320042384383701
2024-08-11 21:06:18,301 - root - INFO - val ap: 0.7952779219871478, new node val ap: 0.8473722631384136
2024-08-11 21:06:18,382 - root - INFO - start 18 epoch
2024-08-11 21:15:20,978 - root - INFO - epoch: 18 took 542.61s
2024-08-11 21:15:20,979 - root - INFO - Epoch mean loss: 0.7818686949799387
2024-08-11 21:15:20,979 - root - INFO - val auc: 0.7907430741221966, new node val auc: 0.8179589276116852
2024-08-11 21:15:20,979 - root - INFO - val ap: 0.794070837477829, new node val ap: 0.8370951866036012
2024-08-11 21:15:21,060 - root - INFO - start 19 epoch
2024-08-11 21:24:21,734 - root - INFO - epoch: 19 took 540.68s
2024-08-11 21:24:21,735 - root - INFO - Epoch mean loss: 0.7771364292866892
2024-08-11 21:24:21,735 - root - INFO - val auc: 0.8075718546524288, new node val auc: 0.7756378216256989
2024-08-11 21:24:21,735 - root - INFO - val ap: 0.8151592557697966, new node val ap: 0.8036159207542048
2024-08-11 21:24:21,817 - root - INFO - start 20 epoch
2024-08-11 21:33:22,550 - root - INFO - epoch: 20 took 540.74s
2024-08-11 21:33:22,550 - root - INFO - Epoch mean loss: 0.7655823427336481
2024-08-11 21:33:22,550 - root - INFO - val auc: 0.7914430690101578, new node val auc: 0.8116463444489677
2024-08-11 21:33:22,550 - root - INFO - val ap: 0.7995575242673849, new node val ap: 0.8308886848373368
2024-08-11 21:33:22,631 - root - INFO - start 21 epoch
2024-08-11 21:42:22,054 - root - INFO - epoch: 21 took 539.43s
2024-08-11 21:42:22,055 - root - INFO - Epoch mean loss: 0.7600105452435282
2024-08-11 21:42:22,055 - root - INFO - val auc: 0.7944707857748051, new node val auc: 0.7785143093586576
2024-08-11 21:42:22,055 - root - INFO - val ap: 0.8044280503771772, new node val ap: 0.8140752679788709
2024-08-11 21:42:22,055 - root - INFO - No improvement over 5 epochs, stop training
2024-08-11 21:42:22,055 - root - INFO - Loading the best model at epoch 16
2024-08-11 21:42:22,062 - root - INFO - Loaded the best model at epoch 16 for inference
2024-08-11 21:45:26,769 - root - INFO - Test statistics: Old nodes -- auc: 0.742908109809752, ap: 0.7563311205077723
2024-08-11 21:45:26,769 - root - INFO - Test statistics: New nodes -- auc: 0.7957676829352431, ap: 0.813917615621823
2024-08-11 21:45:26,770 - root - INFO - Saving PINT model
2024-08-11 21:45:26,849 - root - INFO - PINT model saved
